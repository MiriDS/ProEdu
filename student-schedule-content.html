<div class="col-xl-12">
    <div class="horizontal-responsive">
        <ul class="weekly">
            <li day="1">
                <div class="card">
                    <div class="card-body">
                        <div class="name">
                            Bazar ertəsi
                            <!--<span class="badge badge-primary ml-1">3</span>-->
                        </div>
                        <span class="date"></span>
                    </div>
                </div>
            </li>
            <li day="2">
                <div class="card">
                    <div class="card-body">
                        <div class="name">
                            Çərşənbə axşamı
                            <!--<span class="badge badge-primary ml-1">3</span>-->
                        </div>
                        <span class="date"></span>
                    </div>
                </div>
            </li>
            <li day="3">
                <div class="card">
                    <div class="card-body">
                        <div class="name">
                            Çərşənbə
                            <!--<span class="badge badge-primary ml-1">3</span>-->
                        </div>
                        <span class="date"></span>
                    </div>
                </div>
            </li>
            <li day="4">
                <div class="card">
                    <div class="card-body">
                        <div class="name">
                            Cümə axşamı
                            <!--<span class="badge badge-primary ml-1">0</span>-->
                        </div>
                        <span class="date"></span>
                    </div>
                </div>
            </li>
            <li day="5">
                <div class="card">
                    <div class="card-body">
                        <div class="name">
                            Cümə
                            <!--<span class="badge badge-primary ml-1">0</span>-->
                        </div>
                        <span class="date"></span>
                    </div>
                </div>
            </li>
            <li day="6">
                <div class="card">
                    <div class="card-body">
                        <div class="name">
                            Şənbə
                            <!--<span class="badge badge-primary ml-1">2</span>-->
                        </div>
                        <span class="date"></span>
                    </div>
                </div>
            </li>
            <li day="7">
                <div class="card">
                    <div class="card-body">
                        <div class="name">
                            Bazar
                            <!--<span class="badge badge-primary ml-1">1</span>-->
                        </div>
                        <span class="date"></span>
                    </div>
                </div>
            </li>
        </ul>
    </div>
</div>
<div class="col-xl-12">
    <div class="card">
        <div class="card-body">
            <h5 class="header-title mb-4"><span id="selectedDate"></span> tarixinə olan dərs cədvəli.</h5>

            <div class="table-responsive">
                <table id="student-schedule-table" class="table table-centered table-hover mb-0">
                    <thead>
                    <tr>
                        <th scope="col">Dərs</th>
                        <th scope="col">Başlanma</th>
                        <th scope="col">Bitmə</th>
                        <th scope="col">Fənn</th>
                        <th scope="col">Müəllim</th>
                        <th scope="col">Distant dərs</th>
                    </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>


<script>

    var table = $('#student-schedule-table');
    var groupApiRoute = "student-dashboard";
    var studentScheduleCache = {};
    function getStudentLessons(day) {


        console.log(studentScheduleCache);
        if(typeof studentScheduleCache[day] == 'undefined') {

            table.append(loadingHtml);
            standartRequest(requestType.get,groupApiRoute+'/'+day,'', function(data) {
                studentScheduleCache[day] = data;
                initTable(data);
                $('#loadingHtml').remove();
            });
        }
        else {
            initTable(studentScheduleCache[day]);
        }


    }

    function initTable(data) {

        table.find('tbody').html('');
        for(var n in data) {
            table.find('tbody').append('<tr row_id="'+data[n].id+'"><th scope="row">'+(parseInt(n)+1)+'</th><td>'+(data[n].startsAt)+'</td><td>'+(data[n].endsAt)+'</td><td>'+_.escape(data[n].name)+'</td><td>'+(_.escape(data[n].teacherLastname)+' '+_.escape(data[n].teacherName))+'</td><td><button type="button" class="btn btn-outline-secondary btn-sm join_meeting" data-toggle="tooltip" data-placement="top" title="Online dərsə keçid al"><i class="mdi mdi-camera"></i></button></td></tr>');
        }
    }

    $("li[day]").click(function() {

       var day = $(this).attr('day');
       var date = $(this).find('.date').text();

       if($(this).hasClass('selected'))
           return;

        $("li[day].selected").removeClass('selected');
        $(this).addClass('selected');

        $("#selectedDate").text(date);

        getStudentLessons(day);

    });


    var weekDays = getCurrentWeekDays();
    for(var n in weekDays) {

        $('li[day="'+(parseInt(n)+1)+'"]').find('.date').text(weekDays[n].format('DD.MM.YYYY'));
    }

    table.on('click','.join_meeting',function () {

        var row_id = $(this).closest('[row_id]').attr('row_id');
        standartRequest(requestType.get,'meeting/join/'+row_id,'',function (data) {
            window.open(data);
        });
    });

    //$("li[day]").first().click();
    var d = new Date();
    var n = d.getDay();//console.log(n)
    $("li[day]:eq("+(parseInt(n)-1)+")").first().click();

    $("#activeModuleName").text(personInfo.groupNumber+personInfo.groupName+" sinifin dərs cədvəli");
</script>