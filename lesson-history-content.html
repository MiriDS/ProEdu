
<div class="col-xl-12">
    <div class="card">
        <div class="card-body">
            <div class="table-responsive">
                <table id="lesson-history-table" class="table table-centered table-hover mb-0">
                    <thead>
                    <tr>
                        <th scope="col">#</th>
                        <th scope="col">Tarix</th>
                        <th scope="col">Sinif</th>
                        <th scope="col">Fənn</th>
                        <th scope="col">Müəllim</th>
                        <th scope="col">Müddət</th>
                        <th scope="col">İştirak</th>
                    </tr>
                    </thead>
                    <tbody>

                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script>

    var table = $('#lesson-history-table');
    var groupApiRoute = "meeting";
    var studentScheduleCache = {};

    table.append(loadingHtml);
    standartRequest(requestType.get,groupApiRoute,'', function(data) {
         console.log(data);
        initTable(data);
        $('#loadingHtml').remove();
    });

    function initTable(data) {

        table.find('tbody').html('');
        for(var n in data) {
            table.find('tbody').append('<tr row_id="'+data[n].id+'"><th scope="row">'+(parseInt(n)+1)+'</th><td>'+_.escape(data[n].meetingCreatedAt)+'</td><td>'+_.escape(data[n].groupNumber)+_.escape(data[n].groupName)+'</td><td>'+_.escape(data[n].subjectName)+'</td><td>'+(_.escape(data[n].teacherLastname)+' '+_.escape(data[n].teacherName))+'</td><td>'+_.escape(data[n].duration)+'</td><td>'+(data[n].studentsTotalCount+'/'+data[n].meetingParticipantCount)+(parseInt(data[n].meetingParticipantCount)>0?' <i class="participants dripicons-user" style="cursor: pointer;vertical-align: inherit;"></i>':'')+'</td></td></tr>');
        }
    }

    $("#lesson-history-table").on('click','.participants',function() {

        var row_id = $(this).closest('tr').attr('row_id');
        standartRequest(requestType.get,'meeting/participants/'+row_id,'',function (data) {
            $("#participantList").find('tbody').html('');

            for(var n in data) {
                $("#participantList").find('tbody').append('<tr>' +
                    '<td>'+(parseInt(n)+1)+'</td>' +
                    '<td>'+_.escape(data[n]['lastName'])+' '+_.escape(data[n]['name'])+' ' +_.escape(data[n]['patronymic'])+'</td>' +
                    '<td>'+data[n]['createdAt']+'</td>' +
                    '</tr>')
            }
            $("#participantList").modal('show');
        });
    });

    $("#activeModuleName").text("Dərs tarixçəsi");
</script>